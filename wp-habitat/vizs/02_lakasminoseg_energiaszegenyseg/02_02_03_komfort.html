<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Stacked Barchart</title><link rel="stylesheet" href="/wp-habitat/css/02_02_stacked_barcharts.css"></head><body><div id="main"><svg width="960" height="500"></svg></div><script src="/wp-habitat/js/d3.v4.min.js"></script><script>var svg=d3.select("svg"),margin={top:20,right:20,bottom:30,left:40},width=+svg.attr("width")-margin.left-margin.right,height=+svg.attr("height")-margin.top-margin.bottom,g=svg.append("g").attr("transform","translate("+margin.left+","+margin.top+")"),x=d3.scaleBand().rangeRound([0,width]).paddingInner(.05).align(.1),y=d3.scaleLinear().rangeRound([height,0]),z=d3.scaleOrdinal().range(["#98abc5","#8a89a6","#7b6888","#6b486b","#a05d56","#d0743c","#ff8c00"]);d3.csv("/wp-habitat/data/02_lakasminoseg_energiaszegenyseg/02_02_03_komfort.csv",function(a,e,n){for(e=1,t=0;e<n.length;++e)t+=a[n[e]]=+a[n[e]];return a.total=t,a},function(t,a){if(t)throw t;var e=a.columns.slice(1);x.domain(a.map(function(t){return t.Tized})),y.domain([0,d3.max(a,function(t){return t.total})]).nice(),z.domain(e),g.append("g").selectAll("g").data(d3.stack().keys(e)(a)).enter().append("g").attr("fill",function(t){return z(t.key)}).selectAll("rect").data(function(t){return t}).enter().append("rect").attr("x",function(t){return x(t.data.Tized)}).attr("y",function(t){return y(t[1])}).attr("height",function(t){return y(t[0])-y(t[1])}).attr("width",x.bandwidth()).on("mouseover",function(){tooltip.style("display",null)}).on("mouseout",function(){tooltip.style("display","none")}).on("mousemove",function(t){console.log(t);var a=d3.mouse(this)[0]-5,e=d3.mouse(this)[1]-5;tooltip.attr("transform","translate("+a+","+e+")"),tooltip.select("text").text(t[1]-t[0])}),g.append("g").attr("class","axis").attr("transform","translate(0,"+height+")").call(d3.axisBottom(x)),g.append("g").attr("class","axis").call(d3.axisLeft(y).ticks(null,"s")).append("text").attr("x",2).attr("y",y(y.ticks().pop())+.5).attr("dy","0.32em").attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start");var n=g.append("g").attr("font-family","sans-serif").attr("font-size",10).attr("text-anchor","start").selectAll("g").data(e.slice().reverse()).enter().append("g").attr("transform",function(t,a){return"translate(0,"+20*a+")"});n.append("rect").attr("x",19).attr("width",19).attr("height",19).attr("fill",z),n.append("text").attr("x",45).attr("y",9.5).attr("dy","0.32em").text(function(t){return t})});var tooltip=svg.append("g").attr("class","tooltip").style("display","none");tooltip.append("rect").attr("width",60).attr("height",20).attr("fill","white").style("opacity",.5),tooltip.append("text").attr("x",30).attr("dy","1.2em").style("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold")</script></body></html>