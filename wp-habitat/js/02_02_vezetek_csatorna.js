var svg2=d3.select("#vis-2"),margin={top:20,right:20,bottom:30,left:40},width=+svg2.node().getBoundingClientRect().width-margin.left-margin.right,height=+svg2.attr("height")-margin.top-margin.bottom,g2=svg2.append("g").attr("transform","translate("+margin.left+","+margin.top+")"),x0=d3.scaleBand().rangeRound([0,width]).paddingInner(.1),x1=d3.scaleBand().padding(.05),y=d3.scaleLinear().rangeRound([height,0]),z=d3.scaleOrdinal().range(["#98abc5","#8a89a6","#7b6888"]);d3.csv("/wp-habitat/data/test/02_02_vezetek_csatorna.csv",function(t,a,n){for(var a=1,r=n.length;a<r;++a)t[n[a]]=+t[n[a]];return t},function(t,a){var n,r;if(t)throw t;n=a.columns.slice(1),x0.domain(a.map(function(t){return t.Régió})),x1.domain(n).rangeRound([0,x0.bandwidth()]),y.domain([0,d3.max(a,function(a){return d3.max(n,function(t){return a[t]})})]).nice(),g2.append("g").selectAll("g").data(a).enter().append("g").attr("transform",function(t){return"translate("+x0(t.Régió)+",0)"}).selectAll("rect").data(function(a){return n.map(function(t){return{key:t,value:a[t]}})}).enter().append("rect").attr("x",function(t){return x1(t.key)}).attr("y",function(t){return y(t.value)}).attr("width",x1.bandwidth()).attr("height",function(t){return height-y(t.value)}).attr("fill",function(t){return z(t.key)}),g2.append("g").attr("class","axis").attr("transform","translate(0,"+height+")").call(d3.axisBottom(x0)),g2.append("g").attr("class","axis").call(d3.axisLeft(y).ticks(null,"s")).append("text").attr("x",2).attr("y",y(y.ticks().pop())+.5).attr("dy","0.32em").attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text("%"),(r=g2.append("g").attr("font-family","sans-serif").attr("font-size",10).attr("text-anchor","end").selectAll("g").data(n.slice().reverse()).enter().append("g").attr("transform",function(t,a){return"translate(0,"+20*a+")"})).append("rect").attr("x",width-19).attr("width",19).attr("height",19).attr("fill",z),r.append("text").attr("x",width-24).attr("y",9.5).attr("dy","0.32em").text(function(t){return t})});
