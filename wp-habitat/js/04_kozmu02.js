function MyTitle(){var t=20,e=0,a=60,n=40,r=d3.select("#viscontainer-kozmu02").node().getBoundingClientRect().width-n-e,s=450-t-a,o=d3.select("#svg_kozmu02_title").attr("width",r+n+e).attr("height",26);o.append("text").attr("id","kozmu02_title").attr("x",(r-230)/2+n).attr("y",15).text("Hátralékos fogyasztók a tartozás hossza szerint (2017)")}function stacked_chart(){var e,a,n,r,o,s,i,d,l,c;d3.select("#svg_kozmu02").remove(),e=20,a=0,n=60,r=40,o=d3.select("#viscontainer-kozmu02").node().getBoundingClientRect().width-r-a,s=450-e-n,i=d3.scaleBand().rangeRound([0,o-230]).paddingInner(.05).align(.8),d=d3.scaleLinear().rangeRound([380,0]),l=d3.scaleOrdinal().range(["#385988","#43B02A","#FF671F","#A4343A"]),c=d3.select("#viscontainer-kozmu02").append("svg").attr("width",o+r+a).attr("height",380+e+n).attr("id","svg_kozmu02").append("g").attr("transform","translate("+r+","+e+")"),d3.csv("/wp-habitat/data/04_eladosodas/04_kozmu02.csv",function(e,a,n){for(a=1,t=0;a<n.length;++a)t+=e[n[a]]=+e[n[a]];return e.total=t,e},function(t,e){var a,n,r,s;if(t)throw t;a=e.columns.slice(1),n=c.selectAll(".serie_kozmu02").data(d3.stack().keys(a)(e)).enter().append("g").attr("class","serie_kozmu02"),e.sort(function(t,e){return e.total-t.total}),i.domain(e.map(function(t){return t.name})),d.domain([0,d3.max(e,function(t){return t.total})]).nice(),l.domain(a),n.append("g").selectAll("g").data(d3.stack().keys(a)(e)).enter().append("g").attr("fill",function(t){return l(t.key)}).selectAll("rect").data(function(t){return t}).enter().append("rect").attr("x",function(t){return i(t.data.name)}).attr("y",function(t){return d(t[1])}).attr("height",function(t){return d(t[0])-d(t[1])}).attr("width",i.bandwidth()),c.append("g").attr("class","axis_kozmu02").attr("transform","translate(0,380)").call(d3.axisBottom(i)),c.append("g").attr("class","axis_kozmu02").call(d3.axisLeft(d).ticks(null,"s")).append("text").attr("x",2).attr("y",d(d.ticks().pop())).attr("dy","0.32em").attr("text-anchor","start"),(r=c.append("g").attr("text-anchor","end").selectAll("g").data(a.slice().reverse()).enter().append("g").attr("transform",function(t,e){return"translate(0,"+20*e+")"})).append("rect").attr("x",o-210).attr("width",18).attr("height",18).attr("fill",l),r.append("text").attr("class","legend_kozmu02").attr("x",o-175).attr("y",8).attr("dy","0.32em").attr("text-anchor","start").text(function(t){return t}),(s=c.append("g").attr("class","tooltip_kozmu02").style("visibility","hidden")).append("rect").attr("width",60).attr("height",20).attr("fill","white").attr("stroke","#666").attr("stroke-width","0.5px"),s.append("text").attr("x",30).attr("dy","1.2em").style("text-anchor","middle"),n.selectAll("rect").on("mouseout",function(){s.style("display","none")}).on("mousemove",function(t){var e=t[1]-t[0],a=d3.mouse(this)[0]-40,n=d3.mouse(this)[1]-30;s.style("visibility","visible").style("display","inline").attr("transform","translate("+a+","+n+")").select("text").text(e.toFixed(0))}),n.append("text").attr("id","kozmu02_forras").attr("x",o-230).attr("y",420).attr("text-anchor","end").style("font-size","12px").text("Adatok forrása: MEKH")})}function normalized_chart(){var e,a,n,r,i,s,d,l,c,u,p;function o(e,a,n){for(a=1,t=0;a<n.length;++a)t+=e[n[a]]=+e[n[a]];return e.total=t,e}d3.select("#svg_kozmu02").remove(),e=20,a=0,n=60,r=40,i=d3.select("#viscontainer-kozmu02").node().getBoundingClientRect().width-r-a,s=450-e-n,d=d3.scaleBand().rangeRound([0,i-230]).paddingInner(.05).align(.8),l=d3.scaleLinear().rangeRound([380,0]),c=d3.scaleOrdinal().range(["#385988","#43B02A","#FF671F","#A4343A"]),u=d3.select("#viscontainer-kozmu02").append("svg").attr("width",i+r+a).attr("height",380+e+n).attr("id","svg_kozmu02").append("g").attr("transform","translate("+r+","+e+")"),p=d3.stack().offset(d3.stackOffsetExpand),d3.csv("/wp-habitat/data/04_eladosodas/04_kozmu02.csv",o,function(t,e){var a,n,r,s,o;if(t)throw t;e.sort(function(t,e){return e.total-t.total}),d.domain(e.map(function(t){return t.name})),c.domain(e.columns.slice(1)),(a=u.selectAll(".serie_kozmu02").data(p.keys(e.columns.slice(1))(e)).enter().append("g").attr("class","serie_kozmu02").attr("fill",function(t){return c(t.key)})).selectAll("rect").data(function(t){return t}).enter().append("rect").attr("x",function(t){return d(t.data.name)}).attr("y",function(t){return l(t[1])}).attr("height",function(t){return l(t[0])-l(t[1])}).attr("width",d.bandwidth()),u.append("g").attr("class","axis_kozmu02").attr("transform","translate(0,380)").call(d3.axisBottom(d)),u.append("g").attr("class","axis_kozmu02").call(d3.axisLeft(l).ticks(10,"%")),n=[],r=[],(s=u.selectAll(".legend_kozmu02").data(c.domain().slice().reverse()).enter().append("g").attr("text-anchor","end").attr("class",function(t){return n.push(t.replace(/\s+|[,]+\s/g,"")),r.push(t),"legend"}).attr("transform",function(t,e){return"translate(0,"+20*e+")"})).append("rect").attr("x",i-210).attr("width",18).attr("height",18).style("fill",c).attr("id",function(t,e){return"id"+t.replace(/\s+|[,]+\s/g,"")}),s.append("text").attr("class","legend_kozmu02").attr("x",i-175).attr("y",8).attr("dy","0.32em").attr("text-anchor","start").text(function(t){return t}),(o=u.append("g").attr("class","tooltip_kozmu02").style("display","none")).append("rect").attr("width",60).attr("height",20).attr("fill","white").attr("stroke","#666").attr("stroke-width","0.5px"),o.append("text").attr("x",30).attr("dy","1.2em").style("text-anchor","middle"),a.selectAll("rect").on("mouseover",function(){o.style("display",null)}).on("mouseout",function(){o.style("display","none")}).on("mousemove",function(t){var e=t[1]-t[0],a=d3.mouse(this)[0]-40,n=d3.mouse(this)[1]-30;o.attr("transform","translate("+a+","+n+")").select("text").text((100*e).toFixed(1)+"%")}),a.append("text").attr("id","kozmu02_forras").attr("x",i-230).attr("y",420).text("Adatok forrása: MEKH")})}
