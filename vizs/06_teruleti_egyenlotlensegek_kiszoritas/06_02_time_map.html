<html>

<head>
    <title>A D3 map</title>
    <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
    <script src="../../data/06_teruleti_egyenlotlensegek/habitat_geojson.json"></script>
    <style>
        body {
            position: absolute;
            text-align: center;
            font-family: "Proxima Nova", "Montserrat", sans-serif;
        }
        #sliderContainer {
            position: relative;
            top: 600px;
        }
        #title h1 {
            margin-bottom: 0px;
        }
        #title p {
            margin-top: 2px;
            margin-bottom: 0px;
        }
    </style>
</head>

<body>
    <div id="title">
        <h1>Lakásárak</h1>
        <p>Településenként &middot; 2007-2017</p>
    </div>
    <div id="sliderContainer">
        <input id="timeslide" type="range" min="0" max="10" value="0" step="1" /><br>
        <span id="range">2007</span>
    </div>
    <script>
        var width = 920;
        var height = 580;

        var inputValue = null;
        var time = ["2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017"];

        var svg = d3.select("body")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        var g = svg.append("g");

        var albersProjection = d3.geoAlbers()
            .scale(1000);

        var geoPath = d3.geoPath()
            .projection(albersProjection);

        g.selectAll("path")
            .data(habitat_geojson.features)
            .enter()
            .append("path")
            .attr("fill", initialState)
            .attr("stroke", "#333")
            .attr("d", geoPath);

        // when the input range changes update the rectangle
        d3.select("#timeslide").on("input", function() {
            update(+this.value);
        });

        function update(value) {
            document.getElementById("range").innerHTML = time[value];
            inputValue = time[value];
            d3.selectAll("path")
                .style("fill", timeMatch);
        }

        function timeMatch(data) {
            if (inputValue == "2007") {
                if (data.properties.y2007 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            } else if (inputValue == "2008") {
                if (data.properties.y2008 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            } else if (inputValue == "2009") {
                if (data.properties.y2009 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            } else if (inputValue == "2010") {
                if (data.properties.y2010 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            } else if (inputValue == "2011") {
                if (data.properties.y2011 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            } else if (inputValue == "2012") {
                if (data.properties.y2012 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            } else if (inputValue == "2013") {
                if (data.properties.y2013 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            } else if (inputValue == "2014") {
                if (data.properties.y2014 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            } else if (inputValue == "2015") {
                if (data.properties.y2015 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            } else if (inputValue == "2016") {
                if (data.properties.y2016 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            } else if (inputValue == "2017") {
                if (data.properties.y2017 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            };
        }

        function initialState(data) {
            if (document.getElementById("range").innerHTML == 2007) {
                if (data.properties.y2007 == "D") {
                    return '#084594'
                } else {
                    return '#cb181d'
                }
            };
        }

    </script>
</body>

</html>
